---
layout: post
esbma_id: 1613
title: Wow.
date: 2006-07-19 19:44:01
keywords: wpf
teaser: WPF makes printing 3D stuff unbelievably simple.
---
<p>The last time I worked on an app which used 3D graphics,
printing was fairly simple.&nbsp; OpenGL was brand new and DirectX didn't exist yet,
so we had to do all the projection math anyway.&nbsp; Adapting the code from screen
to paper wasn't a big deal.</p>

<p>Modern graphics APIs are great, but they don't help with
printing.&nbsp; Since I started my woodworking app using C# and Direct3D, I always
figured it would be a huge task to implement printing.&nbsp; More to the point,
since this app is a hobby project and the implementation of printing would
probably be like real work, I figured this app would <i>never</i> be able to
print.</p>

<p>Recently I switched everything over to WPF.&nbsp; Here is my
printing code:</p>

<p style='text-autospace:none'><span style='font-size:10.0pt;
font-family:"Courier New";color:teal'>PrintDialog</span><span style='font-size:
10.0pt;font-family:"Courier New"'> dlg = <span style='color:blue'>new</span> <span
style='color:teal'>PrintDialog</span>();<br>
<span style='color:blue'>if</span> ((<span style='color:blue'>bool</span>)dlg.ShowDialog().GetValueOrDefault())<br>
{<br>
&nbsp;&nbsp;&nbsp; dlg.PrintVisual(myViewport, <span style='color:maroon'>&quot;sawdust&quot;</span>);<br>
}</span></p>

<p>Five lines.&nbsp; Were it not for my pathological need to use
braces on every if statement, it would be three lines.</p>

<p>Yes, yes I know -- a useful real-world printing feature
would require more work.&nbsp; I'm just saying:&nbsp; I added these five lines to my app
and a color picture of my bookshelf model emerged out of the printer down the
hall.&nbsp; That's excellent.</p>

<p></p>