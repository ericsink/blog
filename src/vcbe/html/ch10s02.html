<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><title>Clone, Add, Status, Commit</title><link rel="stylesheet" type="text/css" href="vcbe.css"><meta name="generator" content="DocBook XSL Stylesheets V1.76.1"><link rel="home" href="index.html" title="Version Control by Example"><link rel="up" href="veracity_example.html" title="Chapter 10. Basics with Veracity"><link rel="prev" href="ch10s01.html" title="Create"><link rel="next" href="ch10s03.html" title="Push, Pull, Log, Diff"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">Clone, Add, Status, Commit</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="ch10s01.html">Prev</a> </td><th width="60%" align="center">Chapter 10. Basics with Veracity</th><td width="20%" align="right"> <a accesskey="n" href="ch10s03.html">Next</a></td></tr></table><hr></div><div class="section" title="Clone, Add, Status, Commit"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="idp2255040"></a>Clone, Add, Status, Commit</h2></div></div></div>
    

    <p>By this time Harry is done skiving off and is ready to 
        start coding.  First he needs to clone<a class="indexterm" name="idp2256688"></a> to get his own repository instance<a class="indexterm" name="idp2257200"></a>.</p>

<pre class="screen"><span xmlns:fo="http://www.w3.org/1999/XSL/Format" xmlns:axf="http://www.antennahouse.com/names/XSL/Extensions" class="screen_prompt">~ harry$</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" xmlns:axf="http://www.antennahouse.com/names/XSL/Extensions" class="screen_typed"><span class="screen_emphasis">vv clone</span> http://server.futilisoft.com:8080/repos/lottery lottery</span>
Downloading repository...... Done.                                             
Saving new repository... Done.                                                 
Use 'vv checkout lottery &lt;path&gt;' to get a working copy.
</pre>

<table xmlns:fo="http://www.w3.org/1999/XSL/Format" xmlns:axf="http://www.antennahouse.com/names/XSL/Extensions" align="center" border="0" style="width:350px"><tr><td background="images/eric_aside_08.jpg" style="font-style:italic; padding-left:0.375in; padding-right:0.375in; padding-top:0.25in; padding-bottom:0.25in">
    <p>
        Veracity supports the ability to have more than one
        working copy per repository instance.  It does not store the
        repository instance in the working copy.  Rather, they are stored in an area we
        call the <em class="firstterm">closet</em><a class="indexterm" name="idp2261632"></a>.  The location of the closet is
        configurable.  By default it is in <br><code class="filename">~/.sgcloset</code> (Linux/Mac) or <br><code class="filename">%LOCALAPPDATA%\.sgcloset</code> (Windows).
        </p>
</td></tr></table>

<p>Now Harry needs a working copy<a class="indexterm" name="idp2263840"></a>.</p>

<pre class="screen"><span xmlns:fo="http://www.w3.org/1999/XSL/Format" xmlns:axf="http://www.antennahouse.com/names/XSL/Extensions" class="screen_prompt">~ harry$</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" xmlns:axf="http://www.antennahouse.com/names/XSL/Extensions" class="screen_typed">vv checkout lottery ./lottery</span>

<span xmlns:fo="http://www.w3.org/1999/XSL/Format" xmlns:axf="http://www.antennahouse.com/names/XSL/Extensions" class="screen_prompt">~ harry$</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" xmlns:axf="http://www.antennahouse.com/names/XSL/Extensions" class="screen_typed">cd lottery</span>
</pre>

<p>Since this is Harry’s first time using Veracity, he first sets up his user account<a class="indexterm" name="idp2267856"></a>.</p>

<pre class="screen"><span xmlns:fo="http://www.w3.org/1999/XSL/Format" xmlns:axf="http://www.antennahouse.com/names/XSL/Extensions" class="screen_prompt">lottery harry$</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" xmlns:axf="http://www.antennahouse.com/names/XSL/Extensions" class="screen_typed">vv user create harry</span>

<span xmlns:fo="http://www.w3.org/1999/XSL/Format" xmlns:axf="http://www.antennahouse.com/names/XSL/Extensions" class="screen_prompt">lottery harry$</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" xmlns:axf="http://www.antennahouse.com/names/XSL/Extensions" class="screen_typed">vv whoami harry</span>
</pre>

    <p>Harry wonders if Sally has already done anything in the new repository.</p>

<pre class="screen"><span xmlns:fo="http://www.w3.org/1999/XSL/Format" xmlns:axf="http://www.antennahouse.com/names/XSL/Extensions" class="screen_prompt">lottery harry$</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" xmlns:axf="http://www.antennahouse.com/names/XSL/Extensions" class="screen_typed">ls -al</span>
total 0
drwxr-xr-x   5 harry  staff  170 May 31 10:17 .
drwxr-xr-x  24 harry  staff  816 May 31 10:17 ..
drwxr-xr-x   7 harry  staff  238 May 31 10:17 <span xmlns:fo="http://www.w3.org/1999/XSL/Format" xmlns:axf="http://www.antennahouse.com/names/XSL/Extensions" class="screen_emphasis">.sgdrawer</span>
</pre>

<p>Apparently not.  Nothing here but the <code class="filename">.sgdrawer</code>
    administrative area<a class="indexterm" name="idp2274944"></a>. 
Jolly good then.  It’s time to start coding.  He opens his text editor and
    creates the starting point for their product.</p>

<pre class="programlisting">#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;

int calculate_result(int white_balls[5], int power_ball)
{
    return 0;
}

int main(int argc, char** argv)
{
    if (argc != 7)
    {
        fprintf(stderr, "Usage: %s power_ball (5 white balls)\n", argv[0]);
        return -1;
    }

    int power_ball = atoi(argv[1]);

    int white_balls[5];
    for (int i=0; i&lt;5; i++)
    {
        white_balls[i] = atoi(argv[2+i]);
    }

    int result = calculate_result(white_balls, power_ball);

    printf("%d percent chance of winning\n", result);

    return 0;
}
</pre>

<p>Typical of most initial implementations, this is missing a lot of
    features.  But it’s a good place to begin.  Before committing his
code, he wants to make sure it compiles and runs.</p>

<pre class="screen"><span xmlns:fo="http://www.w3.org/1999/XSL/Format" xmlns:axf="http://www.antennahouse.com/names/XSL/Extensions" class="screen_prompt">lottery harry$</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" xmlns:axf="http://www.antennahouse.com/names/XSL/Extensions" class="screen_typed">gcc -std=c99 lottery.c </span>

<span xmlns:fo="http://www.w3.org/1999/XSL/Format" xmlns:axf="http://www.antennahouse.com/names/XSL/Extensions" class="screen_prompt">lottery harry$</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" xmlns:axf="http://www.antennahouse.com/names/XSL/Extensions" class="screen_typed">ls -l</span>
total 32
-rwxr-xr-x  1 harry  staff  8904 May 31 10:17 a.out
-rw-r--r--  1 harry  staff   555 May 31 10:17 lottery.c

<span xmlns:fo="http://www.w3.org/1999/XSL/Format" xmlns:axf="http://www.antennahouse.com/names/XSL/Extensions" class="screen_prompt">lottery harry$</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" xmlns:axf="http://www.antennahouse.com/names/XSL/Extensions" class="screen_typed">./a.out</span>
Usage: ./a.out power_ball (5 white balls)

<span xmlns:fo="http://www.w3.org/1999/XSL/Format" xmlns:axf="http://www.antennahouse.com/names/XSL/Extensions" class="screen_prompt">lottery harry$</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" xmlns:axf="http://www.antennahouse.com/names/XSL/Extensions" class="screen_typed">./a.out 42 1 2 3 4 5</span>
0 percent chance of winning
</pre>

<p>Righto.  Time to store this file in the repository.
    First Harry needs to add<a class="indexterm" name="idp2283424"></a> the file to the pending changeset.</p>

<pre class="screen"><span xmlns:fo="http://www.w3.org/1999/XSL/Format" xmlns:axf="http://www.antennahouse.com/names/XSL/Extensions" class="screen_prompt">lottery harry$</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" xmlns:axf="http://www.antennahouse.com/names/XSL/Extensions" class="screen_typed">vv add lottery.c</span>
</pre>

<p>Harry uses the status<a class="indexterm" name="idp2286080"></a> operation to make sure the pending changeset looks proper.</p>

<pre class="screen"><span xmlns:fo="http://www.w3.org/1999/XSL/Format" xmlns:axf="http://www.antennahouse.com/names/XSL/Extensions" class="screen_prompt">lottery harry$</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" xmlns:axf="http://www.antennahouse.com/names/XSL/Extensions" class="screen_typed">vv status</span>
   Added:  @/lottery.c
   Found:  @/a.out
</pre>

<p>Veracity is reporting that it found a file it doesn’t know what to do about,
    that <code class="filename">a.out</code> file.  No time to spit the bit.  That’s a compiled
    executable, which should not be stored in a version control repository.
    He can just ignore that.  Now
    it’s time to commit<a class="indexterm" name="idp2289312"></a> the file.</p>

<pre class="screen"><span xmlns:fo="http://www.w3.org/1999/XSL/Format" xmlns:axf="http://www.antennahouse.com/names/XSL/Extensions" class="screen_prompt">lottery harry$</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" xmlns:axf="http://www.antennahouse.com/names/XSL/Extensions" class="screen_typed">vv commit -m "initial implementation"</span>

    revision:  2:8d1b667537d569b307e320004ca7cfb10d8aea64
      branch:  master
         who:  harry
        when:  2011/05/31 10:18:23.640 -0500
     comment:  initial implementation
      parent:  1:b669171b03dfcdb78fb332f3d7b09e62d4f05074
</pre>

</div><div class="navfooter"><hr><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="ch10s01.html">Prev</a> </td><td width="20%" align="center"><a accesskey="u" href="veracity_example.html">Up</a></td><td width="40%" align="right"> <a accesskey="n" href="ch10s03.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top">Create </td><td width="20%" align="center"><a accesskey="h" href="index.html">Home</a> | <a accesskey="t" href="bk01-toc.html">ToC</a></td><td width="40%" align="right" valign="top"> Push, Pull, Log, Diff</td></tr></table></div><script xmlns:fo="http://www.w3.org/1999/XSL/Format" xmlns:axf="http://www.antennahouse.com/names/XSL/Extensions" type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-24709512-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script></body></html>
