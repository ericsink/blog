<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><title>Push, Pull, Log, Diff</title><link rel="stylesheet" type="text/css" href="vcbe.css"><meta name="generator" content="DocBook XSL Stylesheets V1.76.1"><link rel="home" href="index.html" title="Version Control by Example"><link rel="up" href="veracity_example.html" title="Chapter 10. Basics with Veracity"><link rel="prev" href="ch10s02.html" title="Clone, Add, Status, Commit"><link rel="next" href="ch10s04.html" title="Update, Commit (with a merge)"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">Push, Pull, Log, Diff</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="ch10s02.html">Prev</a> </td><th width="60%" align="center">Chapter 10. Basics with Veracity</th><td width="20%" align="right"> <a accesskey="n" href="ch10s04.html">Next</a></td></tr></table><hr></div><div class="section" title="Push, Pull, Log, Diff"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="idp2255296"></a>Push, Pull, Log, Diff</h2></div></div></div>
    

    <p>Sally now needs 
        to clone<a class="indexterm" name="idp2293200"></a> to get her own repository instance.</p>

<pre class="screen"><span xmlns:fo="http://www.w3.org/1999/XSL/Format" xmlns:axf="http://www.antennahouse.com/names/XSL/Extensions" class="screen_prompt">~ sally$</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" xmlns:axf="http://www.antennahouse.com/names/XSL/Extensions" class="screen_typed">vv clone http://server.futilisoft.com:8080/repos/lottery lottery</span>
Downloading repository...... Done.                                             
Saving new repository... Done.                                                 
Use 'vv checkout lottery &lt;path&gt;' to get a working copy.
</pre>

<p>Now Sally needs a working copy.</p>

<pre class="screen"><span xmlns:fo="http://www.w3.org/1999/XSL/Format" xmlns:axf="http://www.antennahouse.com/names/XSL/Extensions" class="screen_prompt">~ sally$</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" xmlns:axf="http://www.antennahouse.com/names/XSL/Extensions" class="screen_typed">vv checkout lottery ./lottery</span>

<span xmlns:fo="http://www.w3.org/1999/XSL/Format" xmlns:axf="http://www.antennahouse.com/names/XSL/Extensions" class="screen_prompt">~ sally$</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" xmlns:axf="http://www.antennahouse.com/names/XSL/Extensions" class="screen_typed">cd lottery</span>
</pre>

<p>Since this is Sally’s first time using Veracity, she first sets up her user account.</p>

<pre class="screen"><span xmlns:fo="http://www.w3.org/1999/XSL/Format" xmlns:axf="http://www.antennahouse.com/names/XSL/Extensions" class="screen_prompt">lottery sally$</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" xmlns:axf="http://www.antennahouse.com/names/XSL/Extensions" class="screen_typed">vv user create sally</span>

<span xmlns:fo="http://www.w3.org/1999/XSL/Format" xmlns:axf="http://www.antennahouse.com/names/XSL/Extensions" class="screen_prompt">lottery sally$</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" xmlns:axf="http://www.antennahouse.com/names/XSL/Extensions" class="screen_typed">vv whoami sally</span>
</pre>

<p>OK, let’s take a look at the initial code Harry committed.</p>

<pre class="screen"><span xmlns:fo="http://www.w3.org/1999/XSL/Format" xmlns:axf="http://www.antennahouse.com/names/XSL/Extensions" class="screen_prompt">lottery sally$</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" xmlns:axf="http://www.antennahouse.com/names/XSL/Extensions" class="screen_typed">ls -al</span>
total 0
drwxr-xr-x   3 sally  staff  102 May 31 10:18 .
drwxr-xr-x  25 sally  staff  850 May 31 10:18 ..
drwxr-xr-x   7 sally  staff  238 May 31 10:18 .sgdrawer
</pre>

<p>Hmmm.  Harry was supposed to commit the initial code, but there’s nothing
here.</p>

<p>But Harry did commit his changes!  Why aren’t they here?  Ah, he forgot to push<a class="indexterm" name="idp2305520"></a>.  Sally screams so loud at Harry that he can hear her all the way across the Pond.</p>

<pre class="screen"><span xmlns:fo="http://www.w3.org/1999/XSL/Format" xmlns:axf="http://www.antennahouse.com/names/XSL/Extensions" class="screen_prompt">lottery harry$</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" xmlns:axf="http://www.antennahouse.com/names/XSL/Extensions" class="screen_typed">vv push</span>
Pushing to http://server.futilisoft.com:8080/repos/lottery:
Pushing... Done.                                                               
</pre>

<p>Now Sally can pull<a class="indexterm" name="idp2308240"></a>.</p>

<pre class="screen"><span xmlns:fo="http://www.w3.org/1999/XSL/Format" xmlns:axf="http://www.antennahouse.com/names/XSL/Extensions" class="screen_prompt">lottery sally$</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" xmlns:axf="http://www.antennahouse.com/names/XSL/Extensions" class="screen_typed">vv pull</span>
Pulling from http://server.futilisoft.com:8080/repos/lottery:
Pulling... Done.                                                               
</pre>

<p>After she has pulled, Sally should have the code, right?</p>

<pre class="screen"><span xmlns:fo="http://www.w3.org/1999/XSL/Format" xmlns:axf="http://www.antennahouse.com/names/XSL/Extensions" class="screen_prompt">lottery sally$</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" xmlns:axf="http://www.antennahouse.com/names/XSL/Extensions" class="screen_typed">ls -al</span>
total 0
drwxr-xr-x   3 sally  staff  102 May 31 10:18 .
drwxr-xr-x  25 sally  staff  850 May 31 10:18 ..
drwxr-xr-x   7 sally  staff  238 May 31 10:18 .sgdrawer
</pre>

<p>Hmmm.  Still not there.  Ah, maybe she needs to <span class="command"><strong>vv update</strong></span><a class="indexterm" name="idp2313424"></a> the working copy.</p>

<pre class="screen"><span xmlns:fo="http://www.w3.org/1999/XSL/Format" xmlns:axf="http://www.antennahouse.com/names/XSL/Extensions" class="screen_prompt">lottery sally$</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" xmlns:axf="http://www.antennahouse.com/names/XSL/Extensions" class="screen_typed">vv update</span>

<span xmlns:fo="http://www.w3.org/1999/XSL/Format" xmlns:axf="http://www.antennahouse.com/names/XSL/Extensions" class="screen_prompt">lottery sally$</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" xmlns:axf="http://www.antennahouse.com/names/XSL/Extensions" class="screen_typed">ls -al</span>
total 8
drwxr-xr-x   4 sally  staff  136 May 31 10:20 .
drwxr-xr-x  25 sally  staff  850 May 31 10:18 ..
drwxr-xr-x   7 sally  staff  238 May 31 10:20 .sgdrawer
-rw-r--r--   1 sally  staff  555 May 31 10:20 lottery.c
</pre>

<p>Now that she has the initial code they had
    previously discussed, Sally is happy as a tick on a fat dog.
    She wants to check the log<a class="indexterm" name="idp2315808"></a> to see the details.</p>

<pre class="screen"><span xmlns:fo="http://www.w3.org/1999/XSL/Format" xmlns:axf="http://www.antennahouse.com/names/XSL/Extensions" class="screen_prompt">lottery sally$</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" xmlns:axf="http://www.antennahouse.com/names/XSL/Extensions" class="screen_typed">vv log</span>

    revision:  <span xmlns:fo="http://www.w3.org/1999/XSL/Format" xmlns:axf="http://www.antennahouse.com/names/XSL/Extensions" class="screen_emphasis">2:8d1b667537d569b307e320004ca7cfb10d8aea64</span>
      branch:  master
         who:  harry
        when:  2011/05/31 10:18:23.640 -0500
     comment:  initial implementation
      parent:  1:b669171b03dfcdb78fb332f3d7b09e62d4f05074

    revision:  1:b669171b03dfcdb78fb332f3d7b09e62d4f05074
         who:  
        when:  2011/05/31 10:16:31.589 -0500
</pre>

<table xmlns:fo="http://www.w3.org/1999/XSL/Format" xmlns:axf="http://www.antennahouse.com/names/XSL/Extensions" align="center" border="0" style="width:350px"><tr><td background="images/eric_aside_08.jpg" style="font-style:italic; padding-left:0.375in; padding-right:0.375in; padding-top:0.25in; padding-bottom:0.25in">
    <p>
Note the way Veracity describes this commit: <code class="code">2:8d1b667537d5…</code>.  At the
lowest level, a Veracity version ID is a cryptographic hash<a class="indexterm" name="idp2322176"></a> (SHA-1, by default).
This is the part after the colon.  Before the colon
is a friendlier version number, one which starts at zero and increases by one
with each new version.  This is more intuitive, but these version numbers are
valid only in one repository instance.
    </p>
</td></tr></table>

<p>When Sally decides to take a look at the code, she immediately finds
    something that makes her nervous as a porcupine in a balloon factory.  The program expects the red ball number to
    be the first argument, followed by the other five.  But in the actual
    lottery, the five white numbers are always drawn and shown first.  She
    worries this will be confusing for users so she decides to fix it.
    Fortunately it is only necessary to modify a few lines of <code class="code">main()</code>.</p>

<pre class="programlisting">    if (argc != 7)
    {
        fprintf(stderr, "Usage: %s (5 white balls) power_ball\n", argv[0]);
        return -1;
    }

    int power_ball = atoi(argv[6]);

    int white_balls[5];
    for (int i=0; i&lt;5; i++)
    {
        white_balls[i] = atoi(argv[1+i]);
    }
</pre>

<p>Now she uses the <span class="sg-operation">status</span><a class="indexterm" name="idp2325648"></a> operation to see the pending changes.</p>

<pre class="screen"><span xmlns:fo="http://www.w3.org/1999/XSL/Format" xmlns:axf="http://www.antennahouse.com/names/XSL/Extensions" class="screen_prompt">lottery sally$</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" xmlns:axf="http://www.antennahouse.com/names/XSL/Extensions" class="screen_typed">vv status</span>
Modified:  @/lottery.c
</pre>

<p>No surprise there.  Veracity knows that <code class="filename">lottery.c</code>
    has been modified.  She wants to double-check by reviewing the actual
    changes.</p>

<pre class="screen"><span xmlns:fo="http://www.w3.org/1999/XSL/Format" xmlns:axf="http://www.antennahouse.com/names/XSL/Extensions" class="screen_prompt">lottery sally$</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" xmlns:axf="http://www.antennahouse.com/names/XSL/Extensions" class="screen_typed">vv diff</span>
=== ================
===   Modified: File @/lottery.c
--- @/lottery.c 76a16c36b9a4cea4a222ff8132f9f242fa04bed1
+++ @/lottery.c 2011/05/31 15:21:39.000 +0000
@@ -11,16 +11,16 @@
 {
     if (argc != 7)
     {
<span xmlns:fo="http://www.w3.org/1999/XSL/Format" xmlns:axf="http://www.antennahouse.com/names/XSL/Extensions" class="screen_diff_del">-        fprintf(stderr, "Usage: %s power_ball (5 white balls)\n", argv[0]);</span>
<span xmlns:fo="http://www.w3.org/1999/XSL/Format" xmlns:axf="http://www.antennahouse.com/names/XSL/Extensions" class="screen_diff_add">+        fprintf(stderr, "Usage: %s (5 white balls) power_ball\n", argv[0]);</span>
         return -1;
     }
 
<span xmlns:fo="http://www.w3.org/1999/XSL/Format" xmlns:axf="http://www.antennahouse.com/names/XSL/Extensions" class="screen_diff_del">-    int power_ball = atoi(argv[1]);</span>
<span xmlns:fo="http://www.w3.org/1999/XSL/Format" xmlns:axf="http://www.antennahouse.com/names/XSL/Extensions" class="screen_diff_add">+    int power_ball = atoi(argv[6]);</span>
 
     int white_balls[5];
     for (int i=0; i&lt;5; i++)
     {
<span xmlns:fo="http://www.w3.org/1999/XSL/Format" xmlns:axf="http://www.antennahouse.com/names/XSL/Extensions" class="screen_diff_del">-        white_balls[i] = atoi(argv[2+i]);</span>
<span xmlns:fo="http://www.w3.org/1999/XSL/Format" xmlns:axf="http://www.antennahouse.com/names/XSL/Extensions" class="screen_diff_add">+        white_balls[i] = atoi(argv[1+i]);</span>
     }
 
     int result = calculate_result(white_balls, power_ball);
</pre>

<p>Ain’t that the berries!?!<a class="indexterm" name="idp2335808"></a></p>

<table xmlns:fo="http://www.w3.org/1999/XSL/Format" xmlns:axf="http://www.antennahouse.com/names/XSL/Extensions" align="center" border="0" style="width:350px"><tr><td background="images/eric_aside_06.jpg" style="font-style:italic; padding-left:0.375in; padding-right:0.375in; padding-top:0.25in; padding-bottom:0.25in">
<p>Veracity’s diff command can be configured to integrate with any file
    comparison tool the user prefers.  But we also included a special command
    which gives seamless integration with <span class="no_line_breaks">SourceGear</span>
    DiffMerge<sup>[<a name="idp2338256" href="#ftn.idp2338256" class="footnote">35</a>]</sup><a class="indexterm" name="idp2338720"></a>, our free application for comparing and merging, supported on Windows, Mac, and Linux.</p>
</td></tr></table>

<pre class="screen"><span xmlns:fo="http://www.w3.org/1999/XSL/Format" xmlns:axf="http://www.antennahouse.com/names/XSL/Extensions" class="screen_prompt">lottery sally$</span> <span xmlns:fo="http://www.w3.org/1999/XSL/Format" xmlns:axf="http://www.antennahouse.com/names/XSL/Extensions" class="screen_typed">vv diffmerge</span>
</pre>

<div class="figure"><a name="diffmerge_02"></a><p class="title"><b>Figure 10.1. Sally’s Changes</b></p><div class="figure-contents">
    
<div class="mediaobject"><img src="images/diffmerge_02.jpg" alt="Sally’s Changes"></div>
</div></div><br class="figure-break">

<div class="footnotes"><br><hr width="100" align="left"><div class="footnote"><p><sup>[<a id="ftn.idp2338256" href="#idp2338256" class="para">35</a>] </sup><a xmlns:fo="http://www.w3.org/1999/XSL/Format" xmlns:axf="http://www.antennahouse.com/names/XSL/Extensions" href="http://www.sourcegear.com/diffmerge/">http://www.sourcegear.com/diffmerge/</a></p></div></div></div><div class="navfooter"><hr><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="ch10s02.html">Prev</a> </td><td width="20%" align="center"><a accesskey="u" href="veracity_example.html">Up</a></td><td width="40%" align="right"> <a accesskey="n" href="ch10s04.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top">Clone, Add, Status, Commit </td><td width="20%" align="center"><a accesskey="h" href="index.html">Home</a> | <a accesskey="t" href="bk01-toc.html">ToC</a></td><td width="40%" align="right" valign="top"> Update, Commit (with a merge)</td></tr></table></div><script xmlns:fo="http://www.w3.org/1999/XSL/Format" xmlns:axf="http://www.antennahouse.com/names/XSL/Extensions" type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-24709512-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script></body></html>
